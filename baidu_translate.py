import json
import execjs
import jsonpath
import requests

headers = {
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.107 Safari/537.36",
    "Cookie": "BIDUPSID=0E61D546F2C10AE26379DDA4CDD2B667; PSTM=1616562460; BAIDUID=0E61D546F2C10AE29A0C6E573C810408:FG=1; REALTIME_TRANS_SWITCH=1; FANYI_WORD_SWITCH=1; SOUND_SPD_SWITCH=1; HISTORY_SWITCH=1; SOUND_PREFER_SWITCH=1; H_WISE_SIDS=107315_110085_127969_128698_131423_151532_154212_165135_166147_167296_167536_169260_169774_170334_170816_170872_171234_171573_171707_172019_172322_172386_172453_172468_172503_172867_172870_172995_173017_173033_173124_173126_173130_173203_173243_173413_173564_173592_173609_173614_173739_173791_173924_174071_174184; BDUSS=REQUx1YVNGUHFNRElKaEdUdjl6MGZRdXZ5OW1UUU9CZVBiT35Tbm5ZRkN1NlZnSVFBQUFBJCQAAAAAAAAAAAEAAABa4yumy9XL1cvV2LzL1cPO0dUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEIufmBCLn5gam; BDUSS_BFESS=REQUx1YVNGUHFNRElKaEdUdjl6MGZRdXZ5OW1UUU9CZVBiT35Tbm5ZRkN1NlZnSVFBQUFBJCQAAAAAAAAAAAEAAABa4yumy9XL1cvV2LzL1cPO0dUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEIufmBCLn5gam; __yjs_duid=1_13ba7f83c1a56a08a1e65d648cc790861619165248283; BDORZ=B490B5EBF6F3CD402E515D22BCDA1598; BAIDUID_BFESS=804B1CA54A95316DAE78A4BE9CB4B1D3:FG=1; H_PS_PSSID=34302_34099_34333_34364_31253_34376_34004_34093_34111_26350; delPer=0; PSINO=5; BCLID=12481422980914960488; BDSFRCVID=oC-OJexroG0YyvRHWWYrhdvtPuweG7bTDYLEOwXPsp3LGJLVJeC6EG0Pts1-dEu-EHtdogKKL2OTHmuF_2uxOjjg8UtVJeC6EG0Ptf8g0M5; H_BDCLCKID_SF=tR3aQ5rtKRTffjrnhPF3hUJDXP6-hnjy3bRkX4Q4WU3RotodbbjM0bLWbttf5q3RymJ42-39LPO2hpRjyxv4y4Ldj4oxJpOJ-bCL0p5aHl51fbbvbURvX5Dg3-7L-x5dtjTO2bc_5KnlfMQ_bf--QfbQ0hOhqP-jBRIE3-oJqC_-hI-R3t; BCLID_BFESS=12481422980914960488; BDSFRCVID_BFESS=oC-OJexroG0YyvRHWWYrhdvtPuweG7bTDYLEOwXPsp3LGJLVJeC6EG0Pts1-dEu-EHtdogKKL2OTHmuF_2uxOjjg8UtVJeC6EG0Ptf8g0M5; H_BDCLCKID_SF_BFESS=tR3aQ5rtKRTffjrnhPF3hUJDXP6-hnjy3bRkX4Q4WU3RotodbbjM0bLWbttf5q3RymJ42-39LPO2hpRjyxv4y4Ldj4oxJpOJ-bCL0p5aHl51fbbvbURvX5Dg3-7L-x5dtjTO2bc_5KnlfMQ_bf--QfbQ0hOhqP-jBRIE3-oJqC_-hI-R3t; Hm_lvt_64ecd82404c51e03dc91cb9e8c025574=1627636750,1627638742,1627892110,1627956457; BA_HECTOR=810h2k8kak858kahss1gghb5f0r; Hm_lpvt_64ecd82404c51e03dc91cb9e8c025574=1627959277; ab_sr=1.0.1_MGQxMmI3NGQ0NGUzMmQ1NWI4ZDdkMzcxYzc2Y2Y5YmUwYWRhMWMyYjMzMGRmZjM4NTA4NTc2MDUxNjRhZTZmMDVlZGUyZmYyZTAwZWY4NDRlYmM0MDgzNjZmYjYzNjMwZTc2OTg1OWUzMTA4ZTQ4YWRiN2E4ZmIxMmNiNjQxYTY4MmE1NTM5Yjk0YmNjNmU1MGU2ZTc4ODExYmJlMmI2Yg==; __yjs_st=2_ZWJlNDgwMjEyNzFhMzkwZDdkN2E2YmIwYzE3MTA3YWUwYjdmZWQ4Y2YwMDJmODE1Yzg2YjQwNDk1MzIwMzU2MDIzZmU4YjRiYzRhNjIwM2UxYmM0NDg4OTExNTEzMjEyN2VkYjRhYzFiNGM4ODBhYzNjMzIwMzMzYTYxOTJjMGMwMmU4OTJkMTNhNmZmMjcyMTAxMGUzNWFiYWU0NWM1MzUzMWY4NjcxMWY4ZWMzYzVhYmUxZWJhOTAzNjE1MzIxYzcyYmYyMzUyNTYzYzY1ZjFiNDdkMTlkY2YzYTA5ZjFkNTU0ZjRlMjk0OGFmZjkwZmY5ODNhMmRlNTAyYzAxNGNlODZlMTA1ZjdlYjUzODQ0ODE5ODlkYTU0Njk1NWFiXzdfMTcwYTdlNDM="
}


def get_sign(query):
    with open(r"./baidutranslate.js", "r", encoding="utf-8") as f:
        ctx = execjs.compile(f.read())
        sign = ctx.call("e", query)
        return sign


def baidu_trans_late(data):
    resp = requests.post("https://fanyi.baidu.com/v2transapi?from=zh&to=en", headers=headers, data=data)
    json_data = json.loads(resp.text)
    result = jsonpath.jsonpath(json_data, '$..data.0.dst')
    print(result)


if __name__ == '__main__':
    query = "蔡徐坤"
    data = {
        "query": f"{query}",
        "sign": get_sign(query),
        "from": "zh",
        "to": "en",
        "transtype": "translang",
        "simple_means_flag": "3",
        "token": "e7b149e3baa886110f7bf0f337855c3b"
    }
    baidu_trans_late(data)

